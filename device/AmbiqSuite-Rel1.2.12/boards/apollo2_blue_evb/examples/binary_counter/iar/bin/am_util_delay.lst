###############################################################################
#
# IAR ANSI C/C++ Compiler V8.30.1.114/W32 for ARM         10/Sep/2018  16:57:41
# Copyright 1999-2018 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\utils\am_util_delay.c
#    Command line =  
#        -f C:\Users\agao\AppData\Local\Temp\EW790A.tmp
#        (C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\utils\am_util_delay.c
#        -D iar -D AM_PACKAGE_BGA -D AM_PART_APOLLO2 -lcN
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\bin
#        --diag_suppress Pa050 -o
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\bin
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M4 -e --fpu=VFPv4_sp --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        8.1\arm\inc\c\DLib_Config_Normal.h" -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\src\
#        -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\..\..\bsp\
#        -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\..\..\..\..\
#        -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\..\..\..\..\utils\
#        -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\..\..\..\..\devices\
#        -I
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\..\..\..\..\..\mcu\apollo2\
#        -On)
#    Locale       =  C
#    List file    =  
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\bin\am_util_delay.lst
#    Object file  =  
#        C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\boards\apollo2_blue_evb\examples\binary_counter\iar\bin\am_util_delay.o
#
###############################################################################

C:\ambiq\AmbiqSuite-Rel1.2.12.tar\AmbiqSuite-Rel1.2.12\AmbiqSuite-Rel1.2.12\utils\am_util_delay.c
      1          //*****************************************************************************
      2          //
      3          //! @file am_util_delay.c
      4          //!
      5          //! @brief A few useful delay functions.
      6          //!
      7          //! Functions for fixed delays.
      8          //
      9          //*****************************************************************************
     10          
     11          //*****************************************************************************
     12          //
     13          // Copyright (c) 2018, Ambiq Micro
     14          // All rights reserved.
     15          // 
     16          // Redistribution and use in source and binary forms, with or without
     17          // modification, are permitted provided that the following conditions are met:
     18          // 
     19          // 1. Redistributions of source code must retain the above copyright notice,
     20          // this list of conditions and the following disclaimer.
     21          // 
     22          // 2. Redistributions in binary form must reproduce the above copyright
     23          // notice, this list of conditions and the following disclaimer in the
     24          // documentation and/or other materials provided with the distribution.
     25          // 
     26          // 3. Neither the name of the copyright holder nor the names of its
     27          // contributors may be used to endorse or promote products derived from this
     28          // software without specific prior written permission.
     29          // 
     30          // Third party software included in this distribution is subject to the
     31          // additional license terms as defined in the /docs/licenses directory.
     32          // 
     33          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     34          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     35          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     36          // ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
     37          // LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     38          // CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     39          // SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     40          // INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     41          // CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     42          // ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
     43          // POSSIBILITY OF SUCH DAMAGE.
     44          //
     45          // This is part of revision 1.2.12 of the AmbiqSuite Development Package.
     46          //
     47          //*****************************************************************************
     48          #include <stdint.h>
     49          #include <stdbool.h>
     50          #include "regs/am_reg_clkgen.h"
     51          #include "hal/am_hal_clkgen.h"
     52          #include "hal/am_hal_flash.h"
     53          #include "am_util_delay.h"
     54          
     55          //*****************************************************************************
     56          //
     57          //! @brief Delays for a desired amount of loops.
     58          //!
     59          //! @param ui32CycleLoops - Desired number of cycle loops to delay for.
     60          //!
     61          //! This function will delay for a number of cycle loops.
     62          //!
     63          //! @note - the number of cycles each loops takes to execute is approximately 3.
     64          //! Therefore the actual number of cycles executed will be ~3x ui32CycleLoops.
     65          //!
     66          //! For example, a ui32CycleLoops value of 100 will delay for 300 cycles.
     67          //!
     68          //! @returns None
     69          //
     70          //*****************************************************************************
     71          void
     72          am_util_delay_cycles(uint32_t ui32Iterations)
     73          {
     74              //
     75              // Call the BOOTROM cycle delay function
     76              //
     77              am_hal_flash_delay(ui32Iterations);
     78          }
     79          
     80          //*****************************************************************************
     81          //
     82          //! @brief Delays for a desired amount of milliseconds.
     83          //!
     84          //! @param ui32MilliSeconds - number of milliseconds to delay for.
     85          //!
     86          //! This function will delay for a number of milliseconds.
     87          //!
     88          //! @returns None
     89          //
     90          //*****************************************************************************
     91          void
     92          am_util_delay_ms(uint32_t ui32MilliSeconds)
     93          {
     94              uint32_t ui32Loops, ui32HFRC;
     95          
     96          #if AM_APOLLO3_CLKGEN
     97              am_hal_clkgen_status_t sClkgenStatus;
     98              am_hal_clkgen_status_get(&sClkgenStatus);
     99              ui32HFRC = sClkgenStatus.ui32SysclkFreq;
    100          #else
    101              ui32HFRC = am_hal_clkgen_sysclk_get();
    102          #endif
    103              ui32Loops = ui32MilliSeconds * (ui32HFRC / 3000);
    104          
    105              //
    106              // Call the BOOTROM cycle delay function
    107              //
    108              am_hal_flash_delay(ui32Loops);
    109          }
    110          
    111          //*****************************************************************************
    112          //
    113          //! @brief Delays for a desired amount of microseconds.
    114          //!
    115          //! @param ui32MicroSeconds - number of microseconds to delay for.
    116          //!
    117          //! This function will delay for a number of microseconds.
    118          //!
    119          //! @returns None
    120          //
    121          //*****************************************************************************
    122          void
    123          am_util_delay_us(uint32_t ui32MicroSeconds)
    124          {
    125              uint32_t ui32Loops, ui32HFRC;
    126          
    127          #if AM_APOLLO3_CLKGEN
    128              am_hal_clkgen_status_t sClkgenStatus;
    129              am_hal_clkgen_status_get(&sClkgenStatus);
    130              ui32HFRC = sClkgenStatus.ui32SysclkFreq;
    131          #else
    132              ui32HFRC = am_hal_clkgen_sysclk_get();
    133          #endif
    134              ui32Loops = ui32MicroSeconds * (ui32HFRC / 3000000);
    135          
    136              //
    137              // Call the BOOTROM cycle delay function
    138              //
    139              am_hal_flash_delay(ui32Loops);
    140          }

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   am_util_delay_cycles
         8   -> am_hal_flash_delay
      16   am_util_delay_ms
        16   -> am_hal_clkgen_sysclk_get
        16   -> am_hal_flash_delay
      16   am_util_delay_us
        16   -> am_hal_clkgen_sysclk_get
        16   -> am_hal_flash_delay


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
      12  am_util_delay_cycles
      30  am_util_delay_ms
      28  am_util_delay_us

 
 74 bytes in section .text
 
 74 bytes of CODE memory

Errors: none
Warnings: none
